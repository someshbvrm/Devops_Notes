
---
# 📦 Docker Volumes Guide

Volumes are used to **persist data** across container lifecycles. Even if a container is deleted, the data inside a volume remains.

There are **3 types of volumes**:

1. **Docker Volumes** (Recommended ✅)
2. **Bind Mounts**
3. **tmpfs** (Supported only on Linux 💡)

---

## 1️⃣ Managing Docker Volumes

### Create a Volume

```bash
docker volume create my-vol   # Creates a volume named my-vol
```

### List Volumes

```bash
docker volume ls
```

### Inspect a Volume

```bash
docker volume inspect my-vol
```

> Volume path in the host instance:
> `/var/lib/docker/volumes/my-vol/_data`

### Remove a Volume

```bash
docker volume rm my-vol
```

---

## 2️⃣ Attaching Volumes to Containers

Volumes can be attached to containers using either `-v` or `--mount` (recommended).

### Using `-v`

```bash
docker run --name mytomcat -v my-vol:/app nginx:latest
```

### Using `--mount` (Recommended)

```bash
docker run --name mytomcat --mount source=my-vol,target=/app nginx:latest
```

---

## 3️⃣ Example: Tomcat Container with Volume

```bash
# Using -v
docker run --name mytomcat -p 8080:8080 -d -v mytomcatvol:/usr/local/tomcat/webapps tomcat:9

# Using --mount
docker run --name mytomcat -p 8081:8080 -d --mount source=mytomcatvol,target=/usr/local/tomcat/webapps tomcat:9
```

> 🔹 **Paths:**
>
> * Volume on host: `/var/lib/docker/volumes/mytomcatvol/_data`
> * Path inside container: `/usr/local/tomcat/webapps`

### Attaching Multiple Volumes

```bash
docker run --name mytomcat -p 8082:8080 -d \
--mount source=mytomcatvol,target=/usr/local/tomcat/webapps \
--mount source=mytomcatlog,target=/usr/local/tomcat/logs \
tomcat:9
```

> ✅ Data persists even if container is deleted.

---

## 4️⃣ Bind Mounts (Custom Host Path)

Instead of using Docker's default volume path, you can mount to a **custom host directory**.

### Mount to Current Directory

```bash
# Using -v
docker run -dit --name devtest -v "$(pwd)"/target:/app nginx:latest

# Using --mount
docker run -dit --name devtest --mount type=bind,source="$(pwd)"/target,target=/app nginx:latest
```

### Mount to Specific Location

```bash
docker run -dit --name devtest --mount type=bind,source=/home/ubuntu/target,target=/usr/local/tomcat/webapps nginx:latest
```

---

## 5️⃣ tmpfs Volumes (Non-Persistent)

* Data is stored in **RAM / swap memory**.
* Not persistent after container shutdown.

```bash
# Using -tmpfs
docker run -d -it --name tmptest -tmpfs /app nginx:latest

# Using --mount
docker run -d -it --name tmptest --mount type=tmpfs,destination=/app nginx:latest
```

> 💡 Use tmpfs for temporary data that does not need to persist.

---

## 6️⃣ Quick Tips

* Prefer **Docker Volumes** for persistent data ✅
* Use **Bind Mounts** for development with host files 🔄
* Use **tmpfs** only for temporary or ephemeral data ⚡
* External ports for containers must be **unique**
* You can attach **multiple volumes** to a single container
* Volume paths in host and container can be mapped differently

---
