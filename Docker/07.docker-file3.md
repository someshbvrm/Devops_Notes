
---

# 🐳 **Docker Image Build & Push Tutorial**

---

## **1️⃣ Build Docker Image Locally**

### **Syntax**

```bash
docker build --tag imagename:tagname .
```

### **Example**

```bash
docker build -t tomcat:1 .
```

---

### **Build Image from Existing Container**

```bash
docker commit mycontainer myimage:1
```

### **Create Container from Built Image**

```bash
docker run --name mycontainer1 -p 8081:8080 -d myimage:1
```

> ⚠ **Note:** `docker commit` **ignores volumes** and any data stored in them.

---

## **2️⃣ Amazon ECR / DockerHub**

* **Amazon Elastic Container Registry (ECR):** Push images to **public/private cloud registry**
* **DockerHub:** Push images to **public/private registry**

> ⚠ Note: For private repos, authentication is required to pull or push images.

---

## **3️⃣ Hands-On: Build Docker Image for Jenkins**

### **Install Docker**

```bash
sudo apt update
sudo apt install docker.io -y
sudo service docker start
sudo systemctl enable docker
sudo usermod -aG docker ubuntu

# Restart session for group changes to take effect
docker info   # Verify Docker is running
```

---

### **Create Project Directory**

```bash
mkdir tomcat
cd tomcat
vi Dockerfile
```

---

### **Sample Dockerfile**

```dockerfile
# Base image
FROM tomcat:latest

# Metadata
LABEL maintainer="info@cloudsoftsol.com"

# Copy Jenkins WAR file
COPY jenkins.war /usr/local/tomcat/webapps/

# Expose Tomcat port
EXPOSE 8080

# Start Tomcat
CMD ["catalina.sh", "run"]
```

---

### **Download Jenkins WAR**

```bash
wget https://updates.jenkins.io/download/war/2.523/jenkins.war
```

---

### **Build Docker Image**

```bash
docker build -t mytomcat:1 .
```

> ⚡ Notes:
>
> * Downloads `tomcat:latest` first
> * Adds layers for WAR file and metadata

### **Verify Images**

```bash
docker images
# Example output:
# tomcat
# mytomcat:1
```

---

## **4️⃣ Push Image to DockerHub**

### **Step 1: Tag Image for DockerHub**

```bash
# Local name: mytomcat:1
# DockerHub repo: someshbvrm/mytomcatjenkins
docker tag mytomcat:1 someshbvrm/mytomcatjenkins:1
```

### **Step 2: Login to DockerHub**

```bash
docker login
# Enter username and password when prompted
```

### **Step 3: Push Image**

```bash
docker push someshbvrm/mytomcatjenkins:1
```

> ✅ **Now your image is available in DockerHub repository**

---

### **Push New Build**

```bash
docker build -t mytomcat:2 .
docker tag mytomcat:2 someshbvrm/mytomcatjenkins:2
docker push someshbvrm/mytomcatjenkins:2
```

---

### **5️⃣ References & Tutorials**

* 🔗 [Interactive Docker Tutorials - Katacoda](https://www.katacoda.com)

---

💡 **Key Notes**

* Always include **username** in DockerHub tag: `username/repo:tag`
* Use **volumes** for persistent data; `docker commit` does not preserve volume data
* Multiple builds can be versioned using tags (`:1`, `:2`, etc.)

---
