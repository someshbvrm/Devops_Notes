
---

# ☸️ Kubernetes: Init Containers, Static Pods, Jobs & CronJobs

---

## 🟢 Init Containers

📌 **Definition**:
An **Init Container** is a special type of container that runs **before** the main application containers in a Pod.
It **must complete successfully** before the main containers start.

🔹 **Use Cases**:

* ⏳ Wait for a service/DB to be ready
* ⚙️ Set up configuration files
* 🗄️ Run DB migrations
* 🔑 Fetch secrets/configs before app runs

---

### 📝 Example 1 – Simple Init Container

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: pod-with-init
spec:
  initContainers:
  - name: init-wait
    image: busybox
    command: ['sh', '-c', 'until nslookup my-service; do sleep 2; done']
  containers:
  - name: app
    image: nginx
```

---

### 📝 Example 2 – Multiple Init Containers

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  labels:
    app.kubernetes.io/name: MyApp
spec:
  containers:
  - name: myapp-container
    image: busybox:1.28
    command: ['sh', '-c', 'echo The app is running! && sleep 3600']

  initContainers:
  - name: init-myservice
    image: busybox:1.28
    command: ['sh', '-c', "until nslookup myservice.$(cat /var/run/secrets/kubernetes.io/serviceaccount/namespace).svc.cluster.local; do echo waiting for myservice; sleep 2; done"]

  - name: init-mydb
    image: busybox:1.28
    command: ['sh', '-c', "until nslookup mydb.$(cat /var/run/secrets/kubernetes.io/serviceaccount/namespace).svc.cluster.local; do echo waiting for mydb; sleep 2; done"]
```

---

## 🔵 Static Pods

📌 **Definition**:
Static Pods are **managed directly by the kubelet**, not by the API server.

🔹 **Key Points**:

* Defined via **YAML manifests** placed in `/etc/kubernetes/manifests/` 📂
* Commonly used for **control plane components** (API server, etcd, scheduler)
* Always bound to a **specific node** (no scheduler involvement)
* API server shows them as **mirror pods** but cannot manage them
* Updating/removing manifest → kubelet automatically applies the change

---

### 📝 Example – Static Pod

Place the file at `/etc/kubernetes/manifests/nginx.yaml`:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx-static
  namespace: default
spec:
  containers:
  - name: nginx
    image: nginx
```

---

## 🟣 Jobs

📌 **Definition**:
A **Job** ensures that **one or more Pods run to completion**.

* ✅ Runs Pods until they finish successfully
* ⚡ Great for **batch tasks** like DB migrations, report generation, or data processing

---

## 🟠 CronJobs

📌 **Definition**:
A **CronJob** builds on Jobs by running them **on a schedule**, just like **Linux cron**.

* 🕒 Used for **recurring tasks** → log cleanup, database backups, periodic reporting

---

## 🔴 Static Pods vs Jobs/CronJobs

| Feature                    | Static Pods 📂                               | Jobs ⚙️                     | CronJobs ⏳                   |
| -------------------------- | -------------------------------------------- | --------------------------- | ---------------------------- |
| **Managed by**             | Kubelet                                      | Control Plane               | Control Plane                |
| **Use Case**               | Control Plane components, node-specific pods | Run once until completion   | Run repeatedly on a schedule |
| **Manifest Location**      | `/etc/kubernetes/manifests/`                 | Applied via `kubectl` / API | Applied via `kubectl` / API  |
| **Can run as Static Pod?** | ✅ Only raw Pods                              | ❌ Jobs not supported        | ❌ CronJobs not supported     |

⚠️ The **kubelet does not understand Job or CronJob objects** — only raw Pod manifests can be static.

---
